<HTML>
<HEAD>
        <script charset="utf-8" src="https://cdn.ethers.io/scripts/ethers-v3.min.js" type="text/javascript">
        </script>

		<script type="text/javascript">
			var abi = [
	{
		"constant": false,
		"inputs": [],
		"name": "kill",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "numberPlayers",
		"outputs": [
			{
				"name": "",
				"type": "int256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getStatus",
		"outputs": [
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "gameStatus",
		"outputs": [
			{
				"name": "id",
				"type": "uint256"
			},
			{
				"name": "message",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getWinner",
		"outputs": [
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "player",
		"outputs": [
			{
				"name": "walletAddress",
				"type": "address"
			},
			{
				"name": "name",
				"type": "string"
			},
			{
				"name": "bet",
				"type": "uint256"
			},
			{
				"name": "winner",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_playerName",
				"type": "string"
			},
			{
				"name": "choise",
				"type": "uint256"
			}
		],
		"name": "makeBet",
		"outputs": [
			{
				"name": "",
				"type": "bool"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "playGame",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "resetGame",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "winPrice",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "betEther",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "message",
				"type": "string"
			}
		],
		"name": "eventPublishStatus",
		"type": "event"
	}
];

      var provider = new ethers.providers.InfuraProvider("rinkeby", "82A3lW4ffPGgkB7UmjTP");
      //var wallet = new ethers.Wallet("0x" + privateKey, provider);

      var contractAddress = "0x2af87dfc1d237d4d38683a43f1483151a1ff51cf";
      var contract = new ethers.Contract(contractAddress, abi, provider);
		</script>

</HEAD>
<BODY>
        <form id="formular" action="" method="POST">
        <!--        <input id="privateKey" type="text" value="" />
				<label for="privateKey">Private Key</label>
				<br />-->
				<input id="playerName" type="text" value="" />
				<label for="playerName">Player Name</label>
				<br />
                <input id="amount" name="amount" type="text" value="1"></input>
				<label for="amount">How much you want to bet? Min. is 1 Ether</label>
				<br />
				<input id="radioRock" name="playerChoise" type="radio" value="0" />
				<label for="radioRock">Rock</label>
				<input id="radioPaper" name="playerChoise" type="radio" value="0" />
				<label for="radioPaper">Paper</label>
				<input id="radioScissor" name="playerChoise" type="radio" value="2" />
				<label for="radioScissor">Scissor</label>
				<br />
                <button id="buttonMakeBet" type="button" onclick="makeBet();">Make bet!</button>
				<button id="buttonPlayGame" type="button" onclick="playGame();">Play!</button>
				<br /><br /><br /><br /><br />
				<div style="border-style: dashed;" id="adminPanel">
					Admin Panel<br />
					<button id="buttonGetStatus" type="button" onclick="getStatus();">get status</button>
					<button id="buttonGetWinner" type="button" onclick="getWinner();">get winner</button>
					<button id="buttonGetNumberPlayers" type="button" onclick="getNumberPlayers();">get player number</button>
				</div>
        </form>

        <script type="text/javascript">

			/*async*/ function makeBet() {
				var privateKey = document.getElementById('privateKey').value;
				var playerName = document.getElementById('playerName').value;
				var amount = document.getElementById('amount').value;
				if(document.getElementById('radioRock').checked) var playerChoise = 0;
				if(document.getElementById('radioPaper').checked) var playerChoise = 1;
				if(document.getElementById('radioScissor').checked) var playerChoise = 2;



				/*
				var balance = await wallet.getBalance("latest");
				console.log(privateKey);
				console.log(playerName);
				console.log(amount);
				console.log(playerChoise);
				console.log(balance.toString());

				document.getElementById('label1').innerHTML = await balance.toString();
				*/
			}

			function playGame() {
//Test
			}

			function getStatus() {
        var callPromiseStatus = contract.getStatus();
        callPromiseStatus.then(function(status) {
          console.log(status);
        });
			}

			function getWinner() {
        var callPromiseWinner = contract.getWinner();
        callPromiseWinner.then(function(winner) {
          console.log(winner);
        });
			}

			function getNumberPlayers() {
        var callPromiseNumberPlayers = contract.numberPlayers();
        callPromiseNumberPlayers.then(function(number) {
          console.log(number);
        })
			}
      </script>
</BODY>
</HTML>
